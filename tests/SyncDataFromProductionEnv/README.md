# 生产数据库同步工具

这是一个用于将生产环境数据同步到脱敏环境的命令行工具。该工具提供了便捷的配置管理和数据同步功能，支持多表同步和配置复用。

## 功能特点

- 📋 配置管理（增删改查）
- 🔄 支持多表同步
- 🚀 实时同步进度显示
- 💾 PostgreSQL数据库存储配置
- 🛡️ 错误重试机制
- 🎨 友好的命令行界面

## 系统要求

- .NET 6.0 或更高版本
- PostgreSQL 数据库
- 网络连接（用于访问同步API）

## 配置说明

### 数据库配置

工具使用PostgreSQL数据库存储同步配置。默认连接字符串：
```
Host=192.168.0.156;Port=30432;Database=newcats;Username=postgres;Password=postgres;
```

### API配置

同步API地址：``

## 使用说明

### 主界面

启动程序后，会显示当前所有同步配置的列表，包含以下信息：
- ID：配置的唯一标识
- Key：同步配置的键值
- 表数量：配置包含的表数量
- 表名列表：需要同步的表名
- 创建时间：配置的创建时间

### 功能选项

1. **使用现有配置同步**
   - 输入配置ID（支持多个，用英文逗号分隔）
   - 系统会显示同步进度和结果

2. **新增配置并同步**
   - 输入要同步的表名（多个表名用英文逗号分隔）
   - 可选择是否手动指定Key
   - 创建后自动执行同步

3. **查询配置详细信息**
   - 输入配置ID
   - 显示完整的配置信息

4. **修改配置Key**
   - 输入配置ID
   - 输入新的Key值

5. **删除配置**
   - 输入配置ID
   - 确认后删除配置

### 使用示例

1. 创建新配置：
```
请选择操作：2
请输入要同步的表名：table1,table2,table3
是否要手动指定Key？(Y/N): N
```

2. 使用现有配置同步：
```
请选择操作：1
请输入要同步的配置ID：1,2,3
```

3. 查询配置信息：
```
请选择操作：3
请输入要查询的配置ID：1
```

## 注意事项

1. 确保数据库连接正常
2. 确保同步API可访问
3. 同步过程中请勿中断程序
4. 建议定期备份配置数据
5. 大量数据同步可能需要较长时间

## 错误处理

工具内置了错误重试机制，对于常见的网络和数据库错误会自动重试。如遇到以下情况：

1. 数据库连接失败
   - 检查数据库服务是否正常
   - 验证连接字符串是否正确

2. API调用失败
   - 检查网络连接
   - 确认API服务是否正常

3. 同步超时
   - 检查数据量是否过大
   - 确认网络状态

## 开发信息

- 开发语言：C#
- 框架版本：.NET 9.0
- 主要依赖：
  - System.Text.Json
  - Npgsql
  - HttpClient

## 更新日志

### v1.0.0 (2024-04-29)
- 初始版本发布
- 实现基本的配置管理功能
- 支持多表同步
- 添加进度显示功能

## 联系方式

如有问题或建议，请联系：
- 作者：Newcats